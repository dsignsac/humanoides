---

---

<div
    id="globe-container"
    class="w-full h-full min-h-[300px] relative overflow-hidden flex items-center justify-center pointer-events-none select-none"
    aria-hidden="true"
>
    <canvas id="globe-canvas" class="w-full h-full absolute inset-0 block"
    ></canvas>
</div>

<script>
    import * as THREE from "three";

    function initGlobe() {
        const container = document.getElementById("globe-container");
        const canvas = document.getElementById("globe-canvas");

        if (!container || !canvas) return;

        // Scene setup
        const scene = new THREE.Scene();

        // Camera
        const camera = new THREE.PerspectiveCamera(
            60,
            container.clientWidth / container.clientHeight,
            0.1,
            1000,
        );
        camera.position.z = 3.5;

        // Renderer with transparency
        const renderer = new THREE.WebGLRenderer({
            canvas,
            alpha: true,
            antialias: true,
        });
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // Create Sphere Geometry
        // Radius 1.4, details 2 (icosahedron)
        const geometry = new THREE.IcosahedronGeometry(1.4, 2);

        // Material: Wireframe
        const material = new THREE.MeshBasicMaterial({
            color: 0x000000, // Black wireframe
            wireframe: true,
            transparent: true,
            opacity: 0.15, // Subtle opacity
        });

        const sphere = new THREE.Mesh(geometry, material);
        scene.add(sphere);

        // Animation Loop
        function animate() {
            requestAnimationFrame(animate);

            // Slow rotation
            sphere.rotation.y += 0.001;
            sphere.rotation.x += 0.0005;

            renderer.render(scene, camera);
        }

        animate();

        // Responsive handling
        const onResize = () => {
            if (!container) return;
            const width = container.clientWidth;
            const height = container.clientHeight;

            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        };

        window.addEventListener("resize", onResize);
    }

    // Initialize on load and view transitions
    initGlobe();
    document.addEventListener("astro:page-load", initGlobe);
</script>
