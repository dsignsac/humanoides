---
import { ClientRouter } from "astro:transitions";
import "../styles/global.css";
import Navbar from "../components/Navbar.astro";

interface Props {
	title?: string;
}

const { title = "HA" } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta
			name="description"
			content="Somos un profesional y sus agentes (IAs), listos para producir tu próximo éxito digital. Eficiencia disruptiva en diseño y desarrollo web."
		/>
		<meta name="author" content="Humanoides & Asociados" />
		<link rel="canonical" href={Astro.url} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={Astro.url} />
		<meta property="og:title" content={title} />
		<meta
			property="og:description"
			content="Somos un profesional y sus agentes, listos para producir tu próximo éxito digital."
		/>
		<meta property="og:image" content="/open-graph-card.png" />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={Astro.url} />
		<meta property="twitter:title" content={title} />
		<meta
			property="twitter:description"
			content="Somos un profesional y sus agentes, listos para producir tu próximo éxito digital."
		/>
		<meta property="twitter:image" content="/open-graph-card.png" />

		<!-- Theme Color -->
		<meta name="theme-color" content="#FA2A2A" />
		<meta name="msapplication-navbutton-color" content="#FA2A2A" />
		<meta
			name="apple-mobile-web-app-status-bar-style"
			content="black-translucent"
		/>

		<!-- Schema.org JSON-LD -->
		<script type="application/ld+json" is:inline>
			{
				"@context": "https://schema.org",
				"@graph": [
					{
						"@type": "Person",
						"@id": "https://humanoidesyasociados.com/#david",
						"name": "David Salcedo",
						"jobTitle": "Creative Director & Founder",
						"url": "https://humanoidesyasociados.com",
						"sameAs": [
							"https://instagram.com/humanoidesyasociados"
						],
						"nationality": "Peruvian"
					},
					{
						"@type": "ProfessionalService",
						"@id": "https://humanoidesyasociados.com/#organization",
						"name": "Humanoides & Asociados",
						"url": "https://humanoidesyasociados.com",
						"logo": "https://humanoidesyasociados.com/humanoides-logo.svg",
						"email": "hola@humanoidesyasociados.com",
						"address": {
							"@type": "PostalAddress",
							"addressCountry": "PE"
						},
						"founder": {
							"@id": "https://humanoidesyasociados.com/#david"
						},
						"brand": {
							"@id": "https://humanoidesyasociados.com/#organization"
						},
						"priceRange": "$$$",
						"description": "Somos un profesional y sus agentes (IAs), listos para producir tu próximo éxito digital. Eficiencia disruptiva en diseño y desarrollo web."
					}
				]
			}
		</script>

		<!-- Google Fonts: Inter & Anek Malayalam -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Anek+Malayalam:wght@100;200;300;400;500;600;700;800&family=Inter:wght@400;500;600&display=swap"
			rel="stylesheet"
		/>

		<ClientRouter />
	</head>
	<body class="min-h-screen">
		<Navbar />
		<slot />

		<script is:inline src="https://unpkg.com/lenis@1.1.20/dist/lenis.min.js"
		></script>
		<script is:inline>
			const lenis = new Lenis({
				duration: 1.2,
				easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
				direction: "vertical",
				gestureDirection: "vertical",
				smoothMultiplier: 1,
			});

			function raf(time) {
				lenis.raf(time);
				requestAnimationFrame(raf);
			}

			requestAnimationFrame(raf);

			document.addEventListener("astro:after-swap", () => {
				lenis.scrollTo(0, { immediate: true });
			});

			// Anchor Link Smooth Scroll
			document.addEventListener("click", (e) => {
				const anchor = e.target.closest('a[href^="/#"]');
				if (anchor) {
					const href = anchor.getAttribute("href");
					const targetId = href.split("#")[1];
					const targetElement = document.getElementById(targetId);
					if (targetElement) {
						e.preventDefault();
						lenis.scrollTo(targetElement, {
							offset: -100, // Offset for fixed navbar
							duration: 1.5,
						});
						// Update URL without jump
						history.pushState(null, null, href);
					}
				}
			});
		</script>
	</body>
</html>
